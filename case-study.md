# Задание №3

## План
- [x] Сделать тест на корректность
- [x] Переделать загрузку на activerecord-import
- [x] Сделать тест на производительность
- [x] Оптимизировать загрузку в бюджете
- [ ] Оптимизировать отдачу
- [ ] Оптимизировать загрузку для обработки 1M записей
- [ ] Оптимизировать загрузку для обработки 10M записей

## Загрузка JSON из 100 тыс. записей 
Изначальная загрузка была неоптимальна, и это было заметно. Воспользовался идеей переделать ее с использованием гема `activerecord-import`. При разработке учитывались такие моменты:

1. Обойти JSON-файл один раз. 
2. Писать в БД сразу короткие таблицы (`cities` и `cervices`)
3. Для остальных таблиц -- создавать данные в памяти при обходе JSON, затем загружать их через вызов `#import`
4. По возможности для этих данных использовать только атирибуты, а не сами объекты.
5. Для HABTM-связки `buses-services` создать промежутучную структуру, заполнить и импортировать.

При запуске полученного решения выяснилось, что оно отрабатывает за ~28 секунд, бюджет был достигнут сразу же. Дальнейшая оптимизация в рамках этого пункта не потребовалась.
